// const {
//     GoogleGenerativeAI,
//     HarmCategory,
//     HarmBlockThreshold,

import { GoogleGenerativeAI } from "@google/generative-ai";

//   } = require("@google/generative-ai");
//   const fs = require("node:fs");
//   const mime = require("mime-types");
  
  const apiKey = import.meta.env.VITE_GEMINI_API_KEY;
  const genAI = new GoogleGenerativeAI(apiKey);
  
  const model = genAI.getGenerativeModel({
    model: "gemini-2.0-flash",
    systemInstruction: "\n",
  });
  
  const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 40,
    maxOutputTokens: 8192,
    responseModalities: [
    ],
    responseMimeType: "application/json",
  };
  
  
    export const chatSession = model.startChat({
      generationConfig,
      history: [
        {
          role: "user",
          parts: [
            {text: "Generate Travel Plan for Location: Las Vegas, for 3 Days for Couple with a Cheap budget,Give me a Hotels options list with\nHotelName, Hotel address, Price, hotel image url, geo coordinates, rating, descriptions and suggest itinerary with placeName, Place Details, Place Image Url, Geo Coordinates, ticket Pricing, Time travel each of the location for 3 days with each day plan with besttime to visit in JSON format.\n"},
          ],
        },
        {
          role: "model",
          parts: [
            {text: "Okay, here's a possible 3-day Las Vegas itinerary for a couple on a budget, along with hotel suggestions and information formatted in JSON.  This plan focuses on free and low-cost activities, taking advantage of the Strip's atmosphere and free attractions.\n\n```json\n{\n  \"tripDetails\": {\n    \"location\": \"Las Vegas, Nevada\",\n    \"duration\": \"3 Days\",\n    \"budget\": \"Cheap (Budget-Friendly)\",\n    \"travelers\": \"Couple\"\n  },\n  \"hotelOptions\": [\n    {\n      \"hotelName\": \"Circus Circus Hotel & Casino\",\n      \"hotelAddress\": \"2880 S Las Vegas Blvd, Las Vegas, NV 89109\",\n      \"price\": \"$30-$70 per night (depending on season and deals)\",\n      \"hotelImageUrl\": \"https://www.circuscircus.com/wp-content/uploads/2023/03/cc-hotel-tower-1600x900.jpg\",\n      \"geoCoordinates\": {\n        \"latitude\": 36.1297,\n        \"longitude\": -115.1657\n      },\n      \"rating\": 3.5,\n      \"description\": \"A classic Vegas hotel with a circus theme.  Offers affordable rooms, free circus acts, and the Adventuredome indoor theme park (additional cost).  Located at the north end of the Strip.\",\n       \"amenities\": [\"Free Circus Shows\", \"Adventuredome Theme Park (extra cost)\", \"Multiple Dining Options\", \"Casino\"]\n    },\n    {\n      \"hotelName\": \"Excalibur Hotel & Casino\",\n      \"hotelAddress\": \"3850 S Las Vegas Blvd, Las Vegas, NV 89109\",\n      \"price\": \"$40-$80 per night (depending on season and deals)\",\n      \"hotelImageUrl\": \"https://www.excalibur.com/content/dam/eclv/page-backgrounds/exterior/eclv-hotel-exterior-night-xl.jpg\",\n      \"geoCoordinates\": {\n        \"latitude\": 36.0953,\n        \"longitude\": -115.1743\n      },\n      \"rating\": 4.0,\n      \"description\": \"A medieval-themed hotel with affordable rooms, a fun atmosphere, and easy access to other MGM properties. Offers Tournament of Kings Dinner Show (additional cost).\",\n      \"amenities\": [\"Tournament of Kings Dinner Show\", \"Multiple Dining Options\", \"Casino\", \"Swimming Pools\"]\n    },\n   {\n      \"hotelName\": \"Linq Hotel & Casino\",\n      \"hotelAddress\": \"3535 S Las Vegas Blvd, Las Vegas, NV 89109\",\n      \"price\": \"$60-$120 per night (depending on season and deals)\",\n      \"hotelImageUrl\": \"https://www.caesars.com/content/dam/linq/amenities/pool/linq-pool-overview-pool-night-view-1200x630.jpg\",\n      \"geoCoordinates\": {\n        \"latitude\": 36.1168,\n        \"longitude\": -115.1696\n      },\n      \"rating\": 4.2,\n      \"description\": \"Modern hotel located in the middle of the strip with a great location to explore the strip. Offers High Roller observation wheel (additional cost).\",\n      \"amenities\": [\"High Roller observation wheel\", \"Multiple Dining Options\", \"Casino\", \"Swimming Pools\"]\n    }\n  ],\n  \"itinerary\": {\n    \"day1\": {\n      \"theme\": \"South Strip Exploration & Free Entertainment\",\n      \"bestTimeToVisit\": \"Morning and Evening\",\n      \"places\": [\n        {\n          \"placeName\": \"Welcome to Fabulous Las Vegas Sign\",\n          \"placeDetails\": \"Iconic sign for a photo opportunity. Free to visit.\",\n          \"placeImageUrl\": \"https://www.lasvegas.com/wp-content/uploads/2023/07/sign_1600x900-1.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.0826,\n            \"longitude\": -115.1725\n          },\n          \"ticketPricing\": \"Free\",\n          \"travelTimeFromHotel\": \"10-15 minutes by car/ride-share from most hotels.\"\n        },\n        {\n          \"placeName\": \"Bellagio Conservatory & Botanical Garden\",\n          \"placeDetails\": \"Beautiful seasonal floral displays. Free to visit.\",\n          \"placeImageUrl\": \"https://www.bellagio.com/content/dam/MGM/bellagio/amenities/conservatory-botanical-garden/bellagio-conservatory-chinese-new-year-2023-1200x630.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1125,\n            \"longitude\": -115.1743\n          },\n          \"ticketPricing\": \"Free\",\n          \"travelTimeFromPrevious\": \"10-15 minutes walking from Welcome Sign, or shorter ride-share.\"\n        },\n        {\n          \"placeName\": \"Bellagio Fountain Show\",\n          \"placeDetails\": \"Spectacular water show synchronized to music. Free to watch. Shows run frequently.\",\n          \"placeImageUrl\": \"https://www.vegas.com/wp-content/uploads/2023/05/bellagio-fountains-spring-1600x900.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1128,\n            \"longitude\": -115.1745\n          },\n          \"ticketPricing\": \"Free\",\n          \"travelTimeFromPrevious\": \"Adjacent to the Conservatory.\"\n        },\n        {\n          \"placeName\": \"Walk the Strip & People Watching\",\n          \"placeDetails\": \"Enjoy the sights and sounds of the Las Vegas Strip. Free.\",\n          \"placeImageUrl\": \"https://www.planetware.com/wpimages/2020/02/las-vegas-best-attractions-walking-the-strip.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1146,\n            \"longitude\": -115.1728\n          },\n          \"ticketPricing\": \"Free\",\n          \"travelTimeFromPrevious\": \"Continuous along the Strip\"\n        }\n      ]\n    },\n    \"day2\": {\n      \"theme\": \"Downtown Las Vegas & Fremont Street Experience\",\n      \"bestTimeToVisit\": \"Afternoon and Evening\",\n      \"places\": [\n        {\n          \"placeName\": \"Fremont Street Experience\",\n          \"placeDetails\": \"Light and sound show on a giant LED canopy. Free to watch.\",\n          \"placeImageUrl\": \"https://www.vegasexperience.com/wp-content/uploads/2023/10/Fremont-Street-Experience-Viva-Vision-Downtown-Las-Vegas.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1703,\n            \"longitude\": -115.1422\n          },\n          \"ticketPricing\": \"Free (some attractions within Fremont Street are paid)\",\n          \"travelTimeFromHotel\": \"20-30 minutes by car/ride-share from the Strip.  Consider taking the Deuce bus for a cheaper option.\"\n        },\n        {\n          \"placeName\": \"Downtown Container Park\",\n          \"placeDetails\": \"Unique shopping and dining area built from shipping containers.\",\n          \"placeImageUrl\": \"https://downtowncontainerpark.com/wp-content/uploads/2023/03/DCP_Header_Main-1.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1671,\n            \"longitude\": -115.1404\n          },\n          \"ticketPricing\": \"Free to enter (prices vary for shops and restaurants)\",\n          \"travelTimeFromPrevious\": \"Short walk from Fremont Street Experience.\"\n        },\n        {\n          \"placeName\": \"Free Live Music on Fremont Street\",\n          \"placeDetails\": \"Several stages offer free live music throughout the day and evening.\",\n          \"placeImageUrl\": \"https://www.reviewjournal.com/wp-content/uploads/2018/05/10552633_web1_fremont-street-051618kd_006.jpg?crop=1\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1703,\n            \"longitude\": -115.1422\n          },\n          \"ticketPricing\": \"Free\",\n          \"travelTimeFromPrevious\": \"Located within Fremont Street Experience.\"\n        }\n      ]\n    },\n    \"day3\": {\n      \"theme\": \"Center Strip & Relaxation\",\n      \"bestTimeToVisit\": \"Morning and Afternoon\",\n      \"places\": [\n        {\n          \"placeName\": \"Mirage Volcano\",\n          \"placeDetails\": \"Volcano show with fire and water effects. Free to watch.\",\n          \"placeImageUrl\": \"https://assets.mgmresorts.com/content/dam/MGM/mirage/entertainment/volcano/mirage-volcano-thumb.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1212,\n            \"longitude\": -115.1752\n          },\n          \"ticketPricing\": \"Free\",\n          \"travelTimeFromHotel\": \"Depends on hotel location. Walking distance if staying center-strip.\"\n        },\n        {\n          \"placeName\": \"High Roller Observation Wheel\",\n          \"placeDetails\": \"30 minutes rotation around the strip. Paid.\",\n          \"placeImageUrl\": \"https://media.cntraveler.com/photos/5774b1aa0a231f280b7a3c53/16:9/w_2560%2Cc_limit/high-roller-gettyimages-469993400.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 36.1168,\n            \"longitude\": -115.1696\n          },\n          \"ticketPricing\": \"Paid.\",\n          \"travelTimeFromPrevious\": \"Walking distance.\"\n        },\n         {\n          \"placeName\": \"Pool Time\",\n          \"placeDetails\": \"Relax and enjoy the pool at your hotel.\",\n          \"placeImageUrl\": \"https://media.cntraveler.com/photos/5c4c587d799c1418d3f5b2c3/16:9/w_2560%2Cc_limit/Pools-Las-Vegas__2019_The-Tank-at-Golden-Nugget.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": null,\n            \"longitude\": null\n          },\n          \"ticketPricing\": \"Free (if included with hotel stay)\",\n          \"travelTimeFromPrevious\": \"At your hotel\"\n        },\n         {\n          \"placeName\": \"Explore the Shops\",\n          \"placeDetails\": \"Window shopping and exploring unique shops at the different hotels (e.g., Grand Canal Shoppes at the Venetian).\",\n          \"placeImageUrl\": \"https://i.ytimg.com/vi/66RRh-hVj_U/maxresdefault.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": null,\n            \"longitude\": null\n          },\n          \"ticketPricing\": \"Free (unless you make a purchase)\",\n          \"travelTimeFromPrevious\": \"Walking Distance.\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Important Notes for Budget Travelers:**\n\n*   **Transportation:**  Utilize the Deuce bus for affordable transportation along the Strip and to Downtown. Walking is also a great (and free) way to explore. Ride-sharing can be convenient, but costs can add up.\n*   **Food:**  Take advantage of happy hour deals, fast-food options, and grocery stores for snacks and drinks to save money on meals.  Look for buffets that offer affordable lunch options.\n*   **Deals and Discounts:** Check websites like Groupon, Travelzoo, and Vegas.com for deals on shows, attractions, and dining.  Sign up for hotel loyalty programs for potential discounts.\n*   **Free Activities:**  Vegas has a lot of free things to do! Take advantage of the free shows, gardens, and attractions.\n*   **Water:** Bring a refillable water bottle and take advantage of free water available at casinos. Staying hydrated is essential, especially in the desert climate.\n*   **Timing:** Consider visiting during the off-season (summer or mid-week) for potentially lower hotel rates. Be aware of extreme heat in the summer months.\n\nThis is just a suggested itinerary, and you can customize it to fit your interests and preferences. Enjoy your trip to Las Vegas!\n"},
          ],
        },
      ],
    });
    // const candidates = result.response.candidates;
    // for(let candidate_index = 0; candidate_index < candidates.length; candidate_index++) {
    //   for(let part_index = 0; part_index < candidates[candidate_index].content.parts.length; part_index++) {
    //     const part = candidates[candidate_index].content.parts[part_index];
    //     if(part.inlineData) {
    //       try {
    //         const filename = `output_${candidate_index}_${part_index}.${mime.extension(part.inlineData.mimeType)}`;
    //         fs.writeFileSync(filename, Buffer.from(part.inlineData.data, 'base64'));
    //         console.log(`Output written to: ${filename}`);
    //       } catch (err) {
    //         console.error(err);
    //       }
    //     }
    //   }
    // }
  
 